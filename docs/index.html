<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebGPU Ray Tracing</title>
    <style>
      /* --- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå…¨ä½“è¨­å®š --- */
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 0;
        width: 100vw;
        height: 100vh; /* ç”»é¢ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
        background: #111;
        color: #eee;
        display: flex;
        flex-direction: column; /* ä¸Šä¸‹ã«é…ç½® */
        overflow: hidden; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¦æ­¢ï¼ˆCanvaså†…ã¯OKï¼‰ */
      }

      /* --- æ“ä½œãƒ‘ãƒãƒ« (ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ) --- */
      .controls {
        flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã« */
        display: flex;
        flex-wrap: wrap; /* â˜…é‡è¦: å…¥ã‚Šåˆ‡ã‚‰ãªã„å ´åˆã¯æŠ˜ã‚Šè¿”ã™ */
        gap: 10px; /* è¦ç´ é–“ã®éš™é–“ */
        align-items: center;
        justify-content: center; /* ä¸­å¤®æƒãˆ */
        padding: 10px;
        background: #222;
        border-bottom: 1px solid #444;
        z-index: 10;
        /* ã‚¹ãƒãƒ›ã§ã®æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã */
        box-sizing: border-box; 
        width: 100%;
      }

      /* å…¥åŠ›ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆæ ã§å›²ã¾ã‚ŒãŸéƒ¨åˆ†ï¼‰ */
      .group {
        display: flex;
        align-items: center;
        flex-wrap: wrap; /* ã‚°ãƒ«ãƒ¼ãƒ—å†…ã‚‚ç‹­ã‘ã‚Œã°æŠ˜ã‚Šè¿”ã™ */
        gap: 5px;
        background: #333;
        padding: 5px 8px;
        border-radius: 4px;
        border: 1px solid #555;
        justify-content: center;
      }

      /* --- UIãƒ‘ãƒ¼ãƒ„ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
      button, select, input {
        padding: 8px 10px;
        font-size: 0.9rem;
        border-radius: 4px;
        border: none;
        outline: none;
      }
      button { background: #4CAF50; color: white; cursor: pointer; white-space: nowrap; }
      button:hover { background: #45a049; }
      
      /* é’ã„ãƒœã‚¿ãƒ³ (Update) */
      button#recompile-btn { background: #2196F3; }
      button#recompile-btn:hover { background: #1976D2; }

    /* ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ã®è¦‹ãŸç›® */
    .file-btn {
      display: inline-block;
      padding: 8px 12px;
      background: #FF9800; /* ã‚ªãƒ¬ãƒ³ã‚¸ */
      color: white;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    .file-btn:hover { background: #F57C00; }

      select, input { background: #444; color: white; border: 1px solid #666; }
      
      /* æ•°å€¤å…¥åŠ›æ¬„ã®å¹… */
      input[type="number"] { width: 55px; text-align: right; }

      .label { color: #aaa; margin-right: 3px; font-size: 0.85rem; white-space: nowrap; }
      .title { font-weight: bold; margin-right: 5px; white-space: nowrap; }

      /* --- Canvasé ˜åŸŸ --- */
      .canvas-wrapper {
        flex-grow: 1; /* ä½™ã£ãŸé ˜åŸŸã‚’åŸ‹ã‚ã‚‹ */
        display: flex;
        align-items: center;
        justify-content: center;
        background: #000;
        width: 100%;
        height: 100%;
        overflow: hidden;
        position: relative;
      }

      canvas {
        display: block;
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        image-rendering: pixelated; /* ä½è§£åƒåº¦ã§ã‚‚ã‚¯ãƒƒã‚­ãƒªè¡¨ç¤º */
        box-shadow: 0 0 30px rgba(0,0,0,0.8);
      }

      /* --- ã‚¹ãƒãƒ›å‘ã‘èª¿æ•´ (ç”»é¢å¹… 600pxä»¥ä¸‹) --- */
      @media (max-width: 600px) {
        .controls {
          padding: 8px 5px;
          gap: 8px;
        }
        .title {
          font-size: 0.9rem;
          width: 100%; /* ã‚¿ã‚¤ãƒˆãƒ«ã‚’1è¡Œç›®ã«ç‹¬å ã•ã›ã‚‹ */
          text-align: center;
          margin-bottom: 5px;
        }
        button, select, input {
          font-size: 0.8rem; /* å°‘ã—æ–‡å­—ã‚’å°ã•ã */
          padding: 6px 8px;  /* ä½™ç™½ã‚’è©°ã‚ã‚‹ */
        }
        input[type="number"] {
          width: 45px; /* å…¥åŠ›æ¬„ã‚’å°‘ã—ç‹­ã */
        }
        .group {
          padding: 4px 6px;
        }
      }
    </style>
    <script type="module" crossorigin src="/webgpu-raytracer/assets/index-BIiL-5sE.js"></script>
  </head>
  <body>
    <div class="controls">
      <div class="title">WebGPU Tracer</div>
      
      <div>
        <select id="scene-select">
          <option value="cornell">Cornell Box</option>
          <option value="spheres">Random Spheres</option>
          <option value="mixed">Mixed Scene</option>
          <option value="special">Special Box</option>
          <option value="mesh">Mesh Scene</option>
          <option value="viewer">Obj Viewer Scene</option>
        </select>
      </div>
      <div class="group">
        <label for="obj-file" class="file-btn">ğŸ“‚ Load OBJ</label>
        <input type="file" id="obj-file" accept=".obj" style="display: none;">
      </div>

      <div class="group">
        <span class="label">Res:</span>
        <input id="res-width" type="number" value="720" step="10" min="10">
        <span class="label">x</span>
        <input id="res-height" type="number" value="480" step="10" min="10">
      </div>

      <div class="group" style="border-color: #2196F3;">
        <span class="label">Depth:</span>
        <input id="max-depth" type="number" value="10" min="1" max="50">
        
        <span class="label" style="margin-left:5px;">SPP:</span>
        <input id="spp-frame" type="number" value="1" min="1" max="100">
        
        <button id="recompile-btn" title="Recompile Shader">Update</button>
      </div>

      <button id="render-btn">Render Start</button>
    </div>

    <div class="canvas-wrapper">
      <canvas id="gpu-canvas" width="720" height="480"></canvas>
    </div>

  </body>
</html>
